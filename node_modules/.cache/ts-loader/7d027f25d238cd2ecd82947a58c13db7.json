{"remainingRequest":"/Users/charon/Desktop/jing/code/vue3_book_codes-main/codes/chapter9/screen-app/node_modules/ts-loader/index.js??ref--13-1!/Users/charon/Desktop/jing/code/vue3_book_codes-main/codes/chapter9/screen-app/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/charon/Desktop/jing/code/vue3_book_codes-main/codes/chapter9/screen-app/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/Users/charon/Desktop/jing/code/vue3_book_codes-main/codes/chapter9/screen-app/src/views/operation-screen/CardTypeUse.vue?vue&type=script&lang=ts","dependencies":[{"path":"/Users/charon/Desktop/jing/code/vue3_book_codes-main/codes/chapter9/screen-app/src/views/operation-screen/CardTypeUse.vue","mtime":1671064436000},{"path":"/Users/charon/Desktop/jing/code/vue3_book_codes-main/codes/chapter9/screen-app/node_modules/cache-loader/dist/cjs.js","mtime":1678071094995},{"path":"/Users/charon/Desktop/jing/code/vue3_book_codes-main/codes/chapter9/screen-app/node_modules/ts-loader/index.js","mtime":1678071095151},{"path":"/Users/charon/Desktop/jing/code/vue3_book_codes-main/codes/chapter9/screen-app/node_modules/cache-loader/dist/cjs.js","mtime":1678071094995},{"path":"/Users/charon/Desktop/jing/code/vue3_book_codes-main/codes/chapter9/screen-app/node_modules/vue-loader-v16/dist/index.js","mtime":1678071098307}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgX19hc3NpZ24gfSBmcm9tICJ0c2xpYiI7CmltcG9ydCB7IGRlZmluZUNvbXBvbmVudCwgcmVhY3RpdmUsIHRvUmVmcywgb25Nb3VudGVkLCBjb21wdXRlZCB9IGZyb20gInZ1ZSI7CmltcG9ydCB7IGRlZXBDb3B5LCBnZXREYXRhTmFtZUJ5VHlwZSwgZ2V0Q29sb3JCeUluZGV4IH0gZnJvbSAiQC91dGlscy9jb21tb24iOwppbXBvcnQgeyBiYXNlSW5mb0NpcmNsZU5vcm1hbE9wdGlvbiB9IGZyb20gIkAvdXRpbHMvY2hhcnQtb3B0aW9ucyI7CmltcG9ydCB7IGNhcmRVc2VSYXRpbyB9IGZyb20gIkAvYXBpL29wZXJhdGlvbi1zY3JlZW4iOwppbXBvcnQgdXNlT3B0aW9ucyBmcm9tICIuL3VzZS1vcHRpb25zIjsKZXhwb3J0IGRlZmF1bHQgZGVmaW5lQ29tcG9uZW50KHsKICAgIG5hbWU6ICJjYXJkLXR5cGUtdXNlIiwKICAgIHByb3BzOiB7CiAgICAgICAgdGl0bGU6IHsKICAgICAgICAgICAgdHlwZTogU3RyaW5nLAogICAgICAgIH0sCiAgICB9LAogICAgc2V0dXA6IGZ1bmN0aW9uIChwcm9wcykgewogICAgICAgIHZhciBjb2xvckFyciA9IFsKICAgICAgICAgICAgeyBzdGFydDogIiNmZmEzMDAiLCBlbmQ6ICIjZmZmYjAwIiB9LAogICAgICAgICAgICB7IHN0YXJ0OiAiIzBiNjlmZiIsIGVuZDogIiMwYmQ2ZmYiIH0sCiAgICAgICAgICAgIHsgc3RhcnQ6ICIjNzMzNGZmIiwgZW5kOiAiI2I4N2VmZiIgfSwKICAgICAgICAgICAgeyBzdGFydDogImxpZ2h0Z3JlZW4iLCBlbmQ6ICJncmVlbiIgfSwKICAgICAgICAgICAgeyBzdGFydDogIiNFRjE4NTAiLCBlbmQ6ICIjRkY3MDk1IiB9LAogICAgICAgIF07CiAgICAgICAgdmFyIF9hID0gdXNlT3B0aW9ucygpLCBzY3JlZW5EYXRhVHlwZSA9IF9hLnNjcmVlbkRhdGFUeXBlLCBnZXRUaXRsZSA9IF9hLmdldFRpdGxlLCBjaGFydFN0eWxlID0gX2EuY2hhcnRTdHlsZTsKICAgICAgICB2YXIgb3B0aW9ucyA9IHJlYWN0aXZlKHsKICAgICAgICAgICAgY2hhcnRPcHRpb246IGRlZXBDb3B5KGJhc2VJbmZvQ2lyY2xlTm9ybWFsT3B0aW9uKSwKICAgICAgICB9KTsKICAgICAgICAvL+WIneWni+WMluaVsOaNrgogICAgICAgIGZ1bmN0aW9uIGluaXREYXRhKCkgewogICAgICAgICAgICBjYXJkVXNlUmF0aW8oeyB0eXBlOiBzY3JlZW5EYXRhVHlwZS52YWx1ZSB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgICAgIHZhciBkYXRhID0gcmVzLmRhdGEuZGF0YTsKICAgICAgICAgICAgICAgIHJlZnJlc2hEYXRhKGRhdGEpOwogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgLy/moLzlvI/ljJZlY2hhcnTphY3nva7pobkKICAgICAgICBmdW5jdGlvbiBmb3JtYXRDaGFydChkYXRhKSB7CiAgICAgICAgICAgIG9wdGlvbnMuY2hhcnRPcHRpb24uY29sb3IgPSBbCiAgICAgICAgICAgICAgICBnZXRDb2xvckJ5SW5kZXgoY29sb3JBcnIsIDApLAogICAgICAgICAgICAgICAgZ2V0Q29sb3JCeUluZGV4KGNvbG9yQXJyLCAxKSwKICAgICAgICAgICAgICAgIGdldENvbG9yQnlJbmRleChjb2xvckFyciwgMiksCiAgICAgICAgICAgICAgICBnZXRDb2xvckJ5SW5kZXgoY29sb3JBcnIsIDMpLAogICAgICAgICAgICAgICAgZ2V0Q29sb3JCeUluZGV4KGNvbG9yQXJyLCA0KSwKICAgICAgICAgICAgXTsKICAgICAgICAgICAgb3B0aW9ucy5jaGFydE9wdGlvbi5zZXJpZXNbMF0uZGF0YSA9IGRhdGEuc2VyaWVzRGF0YTsKICAgICAgICAgICAgb3B0aW9ucy5jaGFydE9wdGlvbi5sZWdlbmQuZGF0YSA9IGRhdGEuc2VyaWVzRGF0YS5tYXAoZnVuY3Rpb24gKG0pIHsKICAgICAgICAgICAgICAgIHJldHVybiBtLm5hbWU7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB2YXIgdG90YWwgPSAwOwogICAgICAgICAgICBkYXRhLnNlcmllc0RhdGEuZm9yRWFjaChmdW5jdGlvbiAobikgewogICAgICAgICAgICAgICAgdG90YWwgKz0gbi52YWx1ZTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIG9wdGlvbnMuY2hhcnRPcHRpb24udGl0bGUuc3VidGV4dCA9IHRvdGFsOwogICAgICAgICAgICBvcHRpb25zLmNoYXJ0T3B0aW9uLmxlZ2VuZC5mb3JtYXR0ZXIgPSBmdW5jdGlvbiAobmFtZSkgewogICAgICAgICAgICAgICAgdmFyIHBhcmFtc1N0cjsKICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5zZXJpZXNEYXRhLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuc2VyaWVzRGF0YVtpXS5uYW1lID09IG5hbWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zU3RyID0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICgoZGF0YS5zZXJpZXNEYXRhW2ldLnZhbHVlIC8gdG90YWwpICogMTAwKS50b0ZpeGVkKDIpICsgIiUiOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHZhciBhcnIgPSBbbmFtZSArICLvvJoiLCBwYXJhbXNTdHJdOwogICAgICAgICAgICAgICAgcmV0dXJuIGFyci5qb2luKCIiKTsKICAgICAgICAgICAgfTsKICAgICAgICAgICAgb3B0aW9ucy5jaGFydE9wdGlvbi50b29sdGlwLmZvcm1hdHRlciA9IGZ1bmN0aW9uIChkYXRhcykgewogICAgICAgICAgICAgICAgdmFyIHJlcyA9IGRhdGFzLm5hbWUgKyAiPGJyLz4iOwogICAgICAgICAgICAgICAgLy8g5aaC5p6c5LiN5Li656m6IO+8jOmCo+S5iOaLvOaOpeWunumZheeahOS/oeaBrwogICAgICAgICAgICAgICAgaWYgKGRhdGFzLnZhbHVlICE9PSAibnVsbCIpIHsKICAgICAgICAgICAgICAgICAgICByZXMgKz0gZGF0YXMubWFya2VyICsgIlx1OTFEMVx1OTg5RFx1RkYxQSIgKyBkYXRhcy52YWx1ZSArICJcdUZGMENcdTc2N0VcdTUyMDZcdTZCRDRcdUZGMUEiICsgZGF0YXMucGVyY2VudCArICIlPGJyLz4iOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHJlczsKICAgICAgICAgICAgfTsKICAgICAgICB9CiAgICAgICAgb25Nb3VudGVkKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgaW5pdERhdGEoKTsKICAgICAgICB9KTsKICAgICAgICB2YXIgY3VyVGl0bGUgPSBjb21wdXRlZChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiBnZXREYXRhTmFtZUJ5VHlwZShzY3JlZW5EYXRhVHlwZS52YWx1ZSkgKyBnZXRUaXRsZShwcm9wcyk7CiAgICAgICAgfSk7CiAgICAgICAgLy/liLfmlrDmlbDmja4KICAgICAgICBmdW5jdGlvbiByZWZyZXNoRGF0YShkYXRhKSB7CiAgICAgICAgICAgIGlmIChkYXRhKSB7CiAgICAgICAgICAgICAgICBmb3JtYXRDaGFydChkYXRhKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gX19hc3NpZ24oX19hc3NpZ24oe30sIHRvUmVmcyhvcHRpb25zKSksIHsgY3VyVGl0bGU6IGN1clRpdGxlLAogICAgICAgICAgICBzY3JlZW5EYXRhVHlwZTogc2NyZWVuRGF0YVR5cGUsCiAgICAgICAgICAgIGNoYXJ0U3R5bGU6IGNoYXJ0U3R5bGUsCiAgICAgICAgICAgIGluaXREYXRhOiBpbml0RGF0YSB9KTsKICAgIH0sCn0pOwo="},{"version":3,"file":"/Users/charon/Desktop/jing/code/vue3_book_codes-main/codes/chapter9/screen-app/src/views/operation-screen/CardTypeUse.vue.ts","sourceRoot":"","sources":["/Users/charon/Desktop/jing/code/vue3_book_codes-main/codes/chapter9/screen-app/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/charon/Desktop/jing/code/vue3_book_codes-main/codes/chapter9/screen-app/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/Users/charon/Desktop/jing/code/vue3_book_codes-main/codes/chapter9/screen-app/src/views/operation-screen/CardTypeUse.vue?vue&type=script&lang=ts"],"names":[],"mappings":"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","sourcesContent":["\nimport { defineComponent, reactive, toRefs, onMounted, computed } from \"vue\";\nimport { deepCopy, getDataNameByType, getColorByIndex } from \"@/utils/common\";\nimport { baseInfoCircleNormalOption } from \"@/utils/chart-options\";\nimport { cardUseRatio } from \"@/api/operation-screen\";\nimport useOptions from \"./use-options\";\nexport default defineComponent({\n  name: \"card-type-use\",\n  props: {\n    title: {\n      type: String,\n    },\n  },\n  setup(props) {\n    const colorArr = [\n      { start: \"#ffa300\", end: \"#fffb00\" },\n      { start: \"#0b69ff\", end: \"#0bd6ff\" },\n      { start: \"#7334ff\", end: \"#b87eff\" },\n      { start: \"lightgreen\", end: \"green\" },\n      { start: \"#EF1850\", end: \"#FF7095\" },\n    ];\n    const { screenDataType, getTitle, chartStyle } = useOptions();\n    const options = reactive({\n      chartOption: deepCopy(baseInfoCircleNormalOption),\n    });\n    //初始化数据\n    function initData() {\n      cardUseRatio({ type: screenDataType.value }).then((res) => {\n        const data = res.data.data;\n        refreshData(data);\n      });\n    }\n    //格式化echart配置项\n    function formatChart(data) {\n      options.chartOption.color = [\n        getColorByIndex(colorArr, 0),\n        getColorByIndex(colorArr, 1),\n        getColorByIndex(colorArr, 2),\n        getColorByIndex(colorArr, 3),\n        getColorByIndex(colorArr, 4),\n      ];\n      options.chartOption.series[0].data = data.seriesData;\n      options.chartOption.legend.data = data.seriesData.map((m) => {\n        return m.name;\n      });\n      let total = 0;\n      data.seriesData.forEach((n) => {\n        total += n.value;\n      });\n      options.chartOption.title.subtext=total;\n      options.chartOption.legend.formatter = (name) => {\n        let paramsStr;\n        for (let i = 0; i < data.seriesData.length; i++) {\n          if (data.seriesData[i].name == name) {\n            paramsStr =\n              ((data.seriesData[i].value / total) * 100).toFixed(2) + \"%\";\n          }\n        }\n        let arr = [name + \"：\", paramsStr];\n        return arr.join(\"\");\n      };\n      options.chartOption.tooltip.formatter = (datas) => {\n        let res = `${datas.name}<br/>`;\n        // 如果不为空 ，那么拼接实际的信息\n        if (datas.value !== \"null\") {\n          res += `${datas.marker}金额：${datas.value}，百分比：${datas.percent}%<br/>`;\n        }\n        return res;\n      };\n    }\n    onMounted(() => {\n      initData();\n    });\n    const curTitle = computed(() => {\n      return getDataNameByType(screenDataType.value) + getTitle(props);\n    });\n    //刷新数据\n    function refreshData(data) {\n      if (data) {\n        formatChart(data);\n      }\n    }\n    return {\n      ...toRefs(options),\n      curTitle,\n      screenDataType,\n      chartStyle,\n      initData,\n    };\n  },\n});\n"]}]}